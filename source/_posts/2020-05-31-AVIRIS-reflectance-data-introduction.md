---
title: AVIRIS反射率数据简介
date: 2020-05-31 21:10:48
categories: 高光谱
tags:
	- 高光谱
	- 数据集
	- AVIRIS
typora-root-url: 2020-05-31-AVIRIS-reflectance-data-introduction
mathjax: true
---

{% note info %}

{% asset_img image-20200601200939930.png  This is an example image %}

AVIRIS高光谱成像光谱仪采集得到的原始图像为辐亮度图像，经过校正后的L1级产品为地表辐亮度信息。但是许多时候，我们更希望知道地面目标物的反射率信息，并且这一信息应该与在地面使用地物光谱仪（如常见的ASD光谱仪）采集的反射率曲线应该一致。因此从原始的辐亮度（Radiance）图像转换生成反射率图像通常需要进行大气校正，水汽吸收校正等过程，最终消除大气传输过程中的各种干扰因素影响，得到最终的反射率曲线。需要注意的是，由于大气水汽吸收的影响，如上图所示，在特定波长波段（1400nm左右与1900nm左右）信号强度非常弱，数据信噪比差，通常会将这些波段认定为无效波段。
{% endnote %}

<!-- more -->

{% note warning%}

**特别注意**：由于AVIRIS服役时间较长，数据采集和处理流程应该经历过多次优化，目前官方文档中介绍反射率图像生成和描述方法中提到的部分描述文件在当前下载到的反射率文件中不存在。因此我综合多个官方文档来理解和描述当前反射率图像数据，可能存在错误。

{% endnote %}

## 1. 基本说明

根据官方文档的描述[^1]，将原始的校正后的AVIRIS辐亮度数据（Radiance Data），通过高光谱-红外图像L2级处理流程，转换生成反射率信息。该处理只针对`HyspIRI Precursor Data Sets`进行，也就是说只有部分图像有对应的反射率图像。文档中具体介绍了该处理流程中的使用的算法、理论假设以及最终结果数据组织等信息。网站上列出的文档最后更新日期为2013年10月，但是在下载到的数据中，有更新版本的文档（最后更新日期为2014年8月），最主要的不同是2014年版本中删除了关于结果数据组织的内容。因为13年版本描述的数据组织方式与我下载的几景图像的数据组织完全不同，可能后续更新过，但是并没有相关文档说明。

根据AVIRIS HyspIRI preparatory campaign measurements任务中关于L2级大气校正算法的描述[^2]，如下图所示，从辐亮度图像到反射率图像主要经过了大气校正和残差抑制两个步骤。具体描述如下。

![L2大气校正流程以及反射率图像生成[^2] ↑](image-20200601203133036.png)

## 2. 大气校正

大气校正是基于ATREM（Atmosphere Removal Algorithm）算法进行的，该算法通过水蒸气、二氧化碳、臭氧、氮氧化物、一氧化碳、甲烷和氧气的吸收作用来反演**等比例的表面反射率**（scaled surface reflectance）。根据这些气体吸收模型，再结合图像的成像几何，可以联合估计400~2500nm的大气透射率。大气散射效应则通过6S模型进行估计，6S模型是利用940nm和1140nm处的水汽吸收特征来反演水蒸气柱浓度，进而估算得到朗伯体表面反射率。

在HyspIRI数据预处理流程中，还增加几个额外的特征：HITRAN 2012 line list中的块吸收，同时估计液态、气态和固态水的三相反演结果。压力高度（Pressure Altitude）则使用氧气A波段的深度进行反演，在成像目标中存在大范围高程变化和多光学路径情况下，该方法能够提高反演精度。

## 3. 经验校正

最终，使用实地对应位置（in situ）的目标测量结果，通过经验模型，来修正表面反射率结果。具体的，为每个波段估计一个**改正系数**项，使得最终机载图像的光谱曲线与实地测量的同名点地物光谱曲线尽量一致。这个**改正系数**存储在以.smth为扩展名的额外对应文件中。如果研究人员希望使用原始数据，那么可以通过将网站提供的校正后的图像逐波段除以该**改正系数**即可。

## 4. 实际数据简介

从网站上实际下载的一景反射率图像中可能包含数个文件，其具体含义如下表所示（**`注：该表格为作者结合文档与数据情况理解制成，可能存在错误`**）

| 文件名称                     | 文件含义                                                     |
| ---------------------------- | ------------------------------------------------------------ |
| `*_corr_v1`, `*_corr_v1.hdr` | ENVI格式的反射率图像，该图像为最终矫正结果。需要注意的是，该图像像素值可能为整型（我下载的2013~2015的几景图像均为整型，2018年为浮点型），其含义是将原始浮点型反射率乘以10000得到的整数部分。也就是说如果想得到反射率数据，需要将像素值除以10000即可。例如某个像素值为2500，则该像素对应的实际反射率为0.25（2500 ÷ 10000 = 0.25）。<br />此外文档中提到的经验**改正系数**存储文件*.smth在下载得到的数据包中并不存在，而在ENVI数据头文件中，存在一项名为`correction factors`的浮点数列表，其中包含n个浮点数（n为波段数量），我猜测这个应该就是文档中提到的经验**改正系数** |
| `*_h2o_v1`，`*_h2o_v1.hdr`   | 这个ENVI图像文件包含三个波段数据，每个波段图像的长宽与反射率图像相同，疑似为文档中提到的水汽的三相反演结果 |
| `*_README_v1.txt`            | 这个就是反射率处理流程的官方说明文档，不同数据中该文件几乎相同，只是最后更新版本的区别。 |

## 参考文档

[^1]: [AVIRIS Surface Reflectance Data Distribution Document - HyspIRI Precursor Data Sets ONLY](http://aviris.jpl.nasa.gov/documents/AVIRIS_HyspIRI_Reflectance_Data.readme)
[^2]: [Level 2 processing of AVIRIS HyspIRI preparatory campaign measurements](https://hyspiri.jpl.nasa.gov/downloads/2014_Symposium/day2/0900_pres_HyspIRI_level2_140604c.pdf)

